## 一、任务：
- 制作windows7或者centos7或者ubuntu的镜像，格式为qcow2
- 利用openstack上传镜像
- 能够成功创建、开启实例

## 二、具体描述：
上周主要是利用一个比较小的镜像来测试虚拟网络，这次尝试制作我们常用的一些镜像。
1. 制作镜像：先下载要制作镜像的iso文件，启动系统
2. 用命令行/dashboard创建镜像
3. 查看镜像的信息、服务
4. 创建实例
5. 尝试用xshell或者桌面远程连接实例（安全组）
参考链接：
https://blog.csdn.net/liuhui_charmingglobe/article/details/60142973
https://blog.csdn.net/liuhui_charmingglobe/article/details/59110406 
https://blog.csdn.net/oyuk06cm/article/details/55259913

## 三、任务完成情况：
| 编号  | 项目内容 | 完成情况  | 未完成原因  | 措施  | 如何解决安装过程中遇到的问题 |
| :--- | :--------| :--------|:------------|:------| :-----------|
| 1    | 制作镜像 |  100%  | / | /| / |
| 2    | 用命令行创建镜像 |  100%  | / |/ | 详见"问题与解决方法" |
| 3    | 查看镜像的信息、服务 | 100%  | / | /| /|
| 4    | 创建实例 | 100% |  / | /| /|
| 5    | 桌面远程连接 | 0% |  暂时还不知道为何无法进行远程桌面连接 | /| /|

任务的完成过程文档请见部署文档

## 四、关于本周的一些学习
### 1、iso和qcow2、img格式的区别
（1）qcow2 镜像格式是 QEMU 模拟器支持的一种磁盘镜像。它也是可以用一个文件的形式来表示一块固定大小的块设备磁盘。它具有小的空间占用，支持写时拷贝（COW, copy-on-write），镜像文件只反映底层磁盘的变化，支持快照（snapshot），镜像文件能够包含多个快照的历史，可选择基于 zlib 的压缩方式，可以选择 AES 加密；qcow2是kvm支持的磁盘镜像格式，我们创建一个100G的qcow2磁盘之后，无论用ls来看，还是du来看，都是很小的。这说明了，qcow2本身会记录一些内部块分配的信息的。使用93/5000  
在qcow2图像格式中使用磁盘映像改进虚拟机的I/O性能。使用qcow2有以下的优点：
- 更小的存储空间，即使是不支持holes的文件系统也可以（这下du-h和ls -lh看到的就一样了）
- Copy-on-write support, where the image only represents changes made to an underlying disk image（这个特性SUN ZFS表现的淋漓尽致）
- 支持多个snapshot，对历史snapshot进行管理
- 支持zlib的磁盘压缩
- 支持AES的加密
（2）img 软盘镜像：IMG是一种文件压缩格式（archive format），主要是为了创建磁盘的映像文件（disk image），它可以用来压缩整个磁盘（通常指软磁盘，Floppy Disk或Diskette）或整片光盘的内容，使用".IMG"这个扩展名的文件就是利用这种文件格式来创建的；	.IMG这个文件格式可视为.ISO格式的一种超集合。由于.ISO只能压缩使用ISO9660和UDF这两种文件系统的存储媒介，意即.ISO只能拿来压缩CD或DVD，因此才发展出了.IMG，它是以.ISO格式为基础另外新增可压缩使用其它文件系统的存储媒介的能力，.IMG可向后兼容于.ISO，如果是拿来压缩CD或DVD，则使用.IMG和.ISO这两种格式所压缩出来的内容是一样的。
（3）iso 光盘镜像：
	iso是一种镜像格式，只能拿来压缩CD或DVD
	
### 2、镜像制作到启动的步骤总结

- 下载ubuntu14-desktop的iso镜像；

-  安装ubuntu虚拟机用于将iso格式的镜像转化为qcow2格式的镜像

- 将iso镜像上传到ubuntu虚拟机上

- 在ubuntu上安装ubuntu

- 在ubuntu上创建一个空的镜像，这块镜像用作硬盘，留出20G的空间大小

- 使用kvm启动一个虚拟机实例

- 在本地使用VNC Veiwer远程连接实例，并且完成ubuntu14的安装

- 将转化好的镜像从虚拟机使用WinSCP下载到本地物理机上

- 在dashboard上传映像

- 以上传的ubuntu镜像创建一个实例

- 成功开启实例无需重复安装，说明创建实例成功
 
### 3、跟镜像相关的openstack的一些命令了解
- 帮助： glance help  | grep image

- 导入镜像的方法：glance image-create --name centos5.8_x86_64 --disk-format=qcow2 --container-format=bare --is-public=True --file=/tmp/centos5.8_x86_64_growroot_1.2_20131231.qcow2  

- 列出当前可用镜像：glance image-list  

- 列出镜像的详细信息： glance details

- 查询某个镜像详细信息方法：glance image-show 0c47db9c-5f74-4544-8ada-0894c1d2c20c  

- 删除镜像：nova image-delete cirros 

- 下载镜像：glance image-download--file /tmp/ centos5.8_x86_64.qcow2   2aad80bf-6fbb-4348-bb20-2c07dbf4f687  

- 查看镜像的默认存储目录：grep ^[a-z] /etc/glance/glance-api.conf   


## 五、问题及解决办法

- 问题一：

<img src="" width="60%" height="" />
