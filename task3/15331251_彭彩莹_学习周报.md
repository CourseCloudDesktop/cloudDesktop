## 本周具体工作计划

1.制作windows7或者centos7或者ubuntu的镜像，格式为qcow2

2.利用openstack上传镜像

3.能够成功创建、开启实例

**具体描述为：**

制作镜像：先下载要制作镜像的iso文件，启动系统

用命令行/dashboard创建镜像

查看镜像的信息、服务

创建实例

尝试用xshell或者桌面远程连接实例（安全组）

## 本周主要工作内容

### i. 已经完成工作
   
   上传iso镜像，启动实例。
   
   - **iso和qcow2、img格式的区别**
   
   iso镜像是光盘的存档文件，一种由光盘上每个写入扇区的数据内容组成的磁盘映像类型，包括光盘文件系统。iso光盘映像是未压缩的，
   不使用特定的容器格式；它们是光盘上数据的逐扇区副本，存储在二进制文件中。iso可以用合适的驱动程序软件“安装”。
   
   qcow2 是 qcow（QEMU Copy On Write）的进化版，是QEMU使用的磁盘镜像文件的文件格式，qcow使用磁盘存储优化策略，将存储分配延迟到实际需要时。
   这种格式的文件可以随着数据的添加而增长，且可以创造快照，而qcow2可以支持创建多个不同快照。但是qcow格式都不能直接被安装。
   
   
   img磁盘映像文件包含磁盘或光盘的原始转储,这些文件只能由能够检测其文件系统的程序自动处理。img和iso文件都不包含原始光盘图像通常存储的CD-ROM或DVD扇区的控制头和错误更正字段。
   
   - **为什么要自己制作镜像**
   
   自己定制镜像使得不用每次启动新实例都要重复配置一次环境，可以节省很多精力，且可以根据自己的需要安装软件，比较方便。
   
   - **镜像制作到启动的步骤总结**
   
   1、先上传一个镜像并启动实例
   
   2、定制该实例
   
   3、创建该实例的快照
   
   4、通过该快照部署新的实例，或者将该快照做成镜像，再通过该镜像部署新的实例
   
   
   - **跟镜像相关的openstack的一些命令了解**
   
   1、上传qcow2镜像
   
   glance image-create --name IMAGE_NAME --file IMAGE_FILEPATH --disk-format qcow2 --container-format bare --is-public true --progress 
   或 openstack image create --disk-format qcow2 --container-format bare --public --IMAGE_FILEPATH IMAGE_NAME
   
   2、查看镜像列表
   
   openstack image list
   
   可以过滤只留下名称含有'cirros'的镜像
   
   openstack image list | grep 'cirros' 
   
   3、查看特定镜像相关信息
   
   openstack image show CirrosImageName
   
   4、查看flavor列表
   
   openstack flavor list
   
   5、查看镜像的位置信息
   
   openstack --os-image-api-version 2 image show imageID
   
   6、更新镜像
   
   openstack image set imageName
   
   7、上传iso镜像
   
   openstack image create ISO_IMAGE --file IMAGE.iso --disk-format iso --container-format bare
   
   8、查看日志或错误信息
   
   查看/var/log/nova/nova-api.log 和 /var/log/nova/nova-compute.log
   
 
### ii. 未完成工作

   1、未创建iso实例的快照。
   
   主要是我的电脑配置和时间问题，电脑经常会卡住，创建一个实例后从启动到设置的最后一步需要**三个小时！**
   
   由于摸索清楚要干什么之后已经是周天早上，而电脑经常卡住要重启，因此时间不太够。
   
   周六时已经掌握启动实例，创建快照，从快照启动实例的步骤，但是用的是img而不是iso文件。
   
   周天时曾经成功创建快照，但是由于当时配置的系统是try ubuntu 而不是 install ubuntu，这个快照没有什么用。
   
   2、未能通过桌面远程连接实例。
   
   在虚拟机输入ssh -i key.pem ubuntu@IP的命令后显示no route to host。
   
   安全组需要加入icmp和ssh相关的规则。
   
   在虚拟机中打开路由器的窗口可以通过ssh命令登录到实例，所以ssh配置好了，但是虚拟机无法ping通实例，估计是外部网络没有设置好。
   
### ii. 问题与困难
   
   1、虚拟机的内存设的太小了，不能创建多个实例。
   
   关闭/删掉其他实例后就能重新创建
   
   2、未能通过桌面远程连接实例。
   
   未解决。
 
## 下周工作计划

   无

## 建议与意见（如有
   
   希望能开一次会讲一下同学遇到的问题和解决办法，讲解一下openstack的架构。
