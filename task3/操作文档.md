
# 操作文档
**任务2也是最近才真正成功的，但是由于任务二的部署文档实在太长，所以就把任务2的部署文档放在任务2那里**

## **一、任务三部署文档**
### 一、制作镜像
#### 1、安装Ubuntu Server虚拟机
  用于将iso文件转化为qcow2文件，安装过程同任务2，这里不再赘述。
#### 2、制作镜像
  （1）将下载好的ubuntu-14.04.5-desktop-amd64.iso文件通过WinSCP上传到Ubuntu Server上；
  
  （2）设置虚拟机处理器支持虚拟化：

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm1.png" width="60%" height="60%" /> 
  

检查虚拟机的虚拟化是否成功：
  
<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm2.png" width="60%" height="60%" /> 
 
有输出代表虚拟化成功的设置

  （3）在Ubuntu Server上安装kvm：

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm3.png" width="60%" height="60%" /> 

对于安装的kvm做一些虚拟化验证：

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm4.png" width="60%" height="60%" /> 

  （4）创建系统盘ubuntu14.qcow2
  
<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm5.png" width="60%" height="60%" /> 
 

  （5）执行命令安装系统：
  
<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm6.png" width="60%" height="60%" /> 

命令解释如下：

- -m表示分给虚拟机的内存是：512M；

- -smp表示分给虚拟机的CPU的数量是4个

- -boot d表示从光盘启动

- -cdrom ubuntu-14.04.5-desktop-amd664.iso 表示指定ubuntu-14.04.5-desktop-amd664.iso作为镜像

  （6）在客户端打开VNC Viewer软件，查看端口3的vnc,并且开始安装系统：
  
<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm7.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm22.png" width="60%" height="60%" /> 


  （7）安装Ubuntu14 desktop一系列过程如下所示：
  
<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm8.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm9.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm10.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm11.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm12.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/vm13.png" width="60%" height="60%" /> 

### 二、创建实例
1、使用WinSCP将镜像从虚拟机下载到本地机器上：

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins1.png" width="60%" height="60%" /> 

 
2、在dashboard上传镜像
 
<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins2.png" width="60%" height="60%" /> 

  
3、创建安全组

- 创建安全组

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins3.png" width="60%" height="60%" /> 

- 编辑管理规则

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins4.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins5.png" width="60%" height="60%" /> 

4、在dashboard上创建实例

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins6.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins7.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins11.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins9.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins10.png" width="60%" height="60%" /> 

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins12.png" width="60%" height="60%" /> 

最终效果展示：

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins13.png" width="60%" height="60%" /> 

5、打开实例看是否成功

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins15.png" width="60%" height="60%" /> 

出现如上界面，表明已经成功的用自己制作的镜像创建了一个实例。

再来看看网络拓扑结构图：

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins17.png" width="60%" height="60%" /> 


## **二、问题与解决办法**

创建实例完成之后，打开界面显示如下图所示：

<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/err1.png" width="60%" height="60%" /> 

解决办法：

根据报错信息可以知道是主机的数量不够，由于在第一次设置flavors选择的是
	
<img src="https://github.com/CourseCloudDesktop/cloudDesktop/blob/yxf-develop/task3/images/ins8.png" width="60%" height="60%" /> 

主要是VCPU的数量不够，所以重新配置了一下实例，选择flavors为m1.small，这样就可以成功的打开实例了。
