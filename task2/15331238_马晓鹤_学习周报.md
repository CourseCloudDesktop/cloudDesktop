# 学习周报

* [本周具体工作计划](#本周具体工作计划)
* [本周主要工作内容](#本周主要工作内容)
* [下周工作计划](#下周工作计划)
* [建议与意见](#建议与意见)

----------
<h3 id="本周具体工作计划"> 1. 本周具体工作计划</h3>

* 用集成脚本安装openstack，能够成功打开dashboard
* 成功搭建openstack环境后，通过dashboard登录
* 登陆后查看系统信息（看启动了什么服务）
* 测试网络配置是否正确
	* 上传cirros镜像、创建flavor、创建vxlan网络、ext_net网络、路由
	* 创建实例
	* 添加安全组规则（ssh、icmp）
	* 尝试从不同实例之间互相ping
* 继续学习openstack


<h3 id="本周主要工作内容"> 2. 本周主要工作内容</h3>

#### （1）已经完成的工作
#### OpenStack学习
**i. OpenStack里面的网络分类**

OpenStack的网络根据用途不同主要可分为三类，管理网络网络、数据网络和外部网络。

* 管理网络：用于OpenStack组件之间的内部通信。这个网络上的IP地址应该仅仅在数据中心内是可达的。
* 数据网络：用于云部署中虚拟机(VM)的数据通信。这个网络上IP地址的要求取决于OpenStack中使用的网络插件。
* 外部网络：用于某些部署方案中提供虚拟机对因特网的访问功能。这个网络上的IP地址应该让因特网上的任意人可达。
	* 应用程序接口(API)网络：显示所有的OpenStack 应用程序接口，包括OpenStack到租户的网络应用接口。这个网络上的IP地址应该让因特网上的任意人可达，该网络可以和外部网络是同一个网络。

Neutron network 可以分为以下五种：

<img src="https://img-blog.csdn.net/2018042912482971?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JlYXNoYXBlcl8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" width=66%>

* local network（本地网络）：只允许在本服务器内通信的虚拟网络，不支持跨服务器的通信，主要用于单节点上测试。
* Flat network：基于不使用 VLAN 的物理网络实现的虚拟网络，每个物理网络最多只能实现一个虚拟网络。
* VLAN network（虚拟局域网） ：基于物理 VLAN 网络实现的虚拟网络。共享同一个物理网络的多个 VLAN 网络是相互隔离的，甚至可以使用重叠的 IP 地址空间。每个支持 VLAN network 的物理网络可以被视为一个分离的 VLAN trunk，它使用一组独占的 VLAN ID，有效的 VLAN ID 范围是 1 到 4094。
* GRE network （通用路由封装网络）：使用 GRE 封装网络包的虚拟网络，GRE 封装的数据包基于 IP 路由表来进行路由，因此 GRE network 不和具体的物理网络绑定。
* VXLAN network（虚拟可扩展网络）：基于 VXLAN 实现的虚拟网络。同 GRE network 一样， VXLAN network 中 IP 包的路由也基于 IP 路由表，也不和具体的物理网络绑定。

**ii. 浮动IP**

* 浮动IP（虚拟网络对应的外部网络上的IP）是一些可以从外部访问的ip列表，需要用户手动从地址池里抓取然后赋予给实例。
* 在创建实例时如果不设置浮动IP，这些实例会被赋予固定IP，这时外界网络可能不能马上访问到这些实例。
* 浮动IP是配置在路由器的外网接口上，而非实例上。一般来说需要配置防火墙允许公共IP，然后建立一条NAT规则对应到实例上，使外网访问到租户网络中的实例。

**iii. 创建一个实例会用到什么组件**

![这里写图片描述](https://img-blog.csdn.net/20180414190917191?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JlYXNoYXBlcl8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

创建一个实例时：

* user向keystone发送认证信息，通过keystone的认证，认为其是合法的用户，就会返回一个token，用户拿到token后，用户就可以发送创建VM的请求了。
* 用户将请求和token一起发送给Nova，即计算资源管理组件，Nova接到请求后，首先到keystone上验证这个token，验证通过后，接下来处理这个请求。
* Nova要创建VM，到Glance上申请一个镜像，申请时也携带该token，Glance首先也要验证这个token，通过后，Glance查询镜像，如果找到该镜像，返回给Nova组件。
* Nova接下来用token与请求信息到Neutron申请网络资源，Neutron验证后，为Nova分配资源。* * Nova拿到需要的所有资源后，才可以创建VM，返回给用户。

因此需要的组件有**keystone**、**Nova**、**Glance**、**Neutron**。
#### 安装OpenStack，通过dashboard登录

![这里写图片描述](https://img-blog.csdn.net/20180427234916966?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JlYXNoYXBlcl8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

#### 登陆后查看系统信息（看启动了什么服务）

![这里写图片描述](https://img-blog.csdn.net/20180427235820386?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JlYXNoYXBlcl8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

#### 创建实例

![这里写图片描述](https://img-blog.csdn.net/20180427234949426?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JlYXNoYXBlcl8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

![这里写图片描述](https://img-blog.csdn.net/20180427234927288?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JlYXNoYXBlcl8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

#### 不同实例之间互ping
实例互ping：

<img src="https://img-blog.csdn.net/20180427235445550?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JlYXNoYXBlcl8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" width=70%>
与外界相ping：

<img src="https://img-blog.csdn.net/20180427234938232?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JlYXNoYXBlcl8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" width=70%>


#### （2）未完成的工作
无。

#### （3）问题与困难
安装过程中，总是安装到**nova-computer**，进度为55%时失败。
解决方法：

* 虚拟机的网络配置/etc/network/interfaces中，eth0设置为静态ip，eth1设置为动态获取。
* 虚拟机设置一个NAT模式的网络适配器，一个为仅主机模式的网络适配器，二者所处不同网段。

<h3 id="下周工作计划"> 3. 下周工作计划</h3>
跟着TA的计划进行下一步的工作，继续深入学习OpenStack。
<h3 id="建议与意见"> 4. 建议与意见</h3>
无。

