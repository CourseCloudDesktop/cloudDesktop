# task4 部署文档
## 一、task3 补充部分
在上次的作业中我们直接用了img镜像文件，没有正确理解作业要求，所以这次选择ubuntu-14.04.1-desktop-amd64.iso版本，重新用iso文件制作格式为qcow2的镜像，上传并启动实例。  
制作镜像前要开启CPU支持虚拟化，vmware具体操作为：虚拟机-设置-硬件-处理器-虚拟化引擎-勾选[虚拟化Intel VT-x/EPT 或 AMD-V/RVI(V)]。

**1.用filezilla将iso镜像上传至虚拟机/root目录下，之后创建系统盘ubuntu_image.qcow2**  
创建系统盘命令：  
`qemu-img create -f qcow2 ubuntu_image.qcow2 20G`  
ls命令显示/root目录下创建好的ubuntu_image.qcow2和上传的iso文件：  
![上传iso创建系统盘](https://github.com/CourseCloudDesktop/cloudDesktop/blob/wcl-develop/task4/images/1_上传iso创建系统盘.PNG)  
**2.qemu-system-x86命令开启虚拟机，用vnc viewer连接后制作镜像**  
参考[博客](https://blog.csdn.net/wanghuiyao/article/details/65627198)，利用kvm命令（qemu-system-x86_64）在虚拟机中启动虚拟机、制作需要的镜像。  
![启动虚拟机](https://github.com/CourseCloudDesktop/cloudDesktop/blob/wcl-develop/task4/images/2_启动虚拟机.PNG)  
添加参数-vnc ：3，设置将视频流输出到vnc管道，远端可以使用虚拟机的ip和vnc的端口，使用vnc viewer连接  
![vnc连接](https://github.com/CourseCloudDesktop/cloudDesktop/blob/wcl-develop/task4/images/3_vnc连接.PNG)  
vnc view连接到打开的虚拟机，按照安装指示完成ubuntu的安装部分，之后创建一个文件写入小组branch名称，完成镜像的制作，关掉vnc view即可。  
**3.用命令行上传制作好的qcow2镜像**  
也可以通过filezilla将/root目录下的ubuntu_image.qcow2下载下来再通过网页上传，不过由于镜像较大，网页上传速度较慢，选择了用命令行直接上传。  
![创建映像](https://github.com/CourseCloudDesktop/cloudDesktop/blob/wcl-develop/task4/images/4_创建映像.PNG)  
上传成功后，可以在dashboard中查看到上传的实例：  
![dashboard查看映像](https://github.com/CourseCloudDesktop/cloudDesktop/blob/wcl-develop/task4/images/5_dashboard查看映像.PNG)  
**4.用上传的qcow2镜像启动一个新的实例**  
创建实例的过程在前几次作业中都有涉及，不再赘述，创建好实例后可以成功开启，从控制台进入实例，不需要再安装系统，打开的就是之前制作好的系统  
![控制台进入实例](https://github.com/CourseCloudDesktop/cloudDesktop/blob/wcl-develop/task4/images/6_控制台进入实例.PNG)  
利用制作镜像时设置的用户及密码进入系统，桌面上有之前已经做好的写有分支名称的文件  
![显示小组文件](https://github.com/CourseCloudDesktop/cloudDesktop/blob/wcl-develop/task4/images/7_显示小组文件.PNG)  

## 二、子任务1：虚拟网络部分配置
## 三、子任务2：镜像制作
## 四、子任务3：安装云桌面
-----
小组成员