# 学习周报

## 1. 本周具体工作计划

### 1.1 了解基础概念

- openstack
OpenStack是一个由NASA和Rackspace合作研发并发起，以Apache许可证授权的自由软件和开放源代码项目。它是一个开源的云计算管理平台，由几个主要的组件组合起来完成具体工作。OpenStack支持几乎所有类型的云环境，项目目标是提供实施简单、可大规模扩展、丰富、标准统一的云计算管理平台，通过各种互补的服务提供了基础设施即服务（IaaS）的解决方案，每个服务提供API以进行集成。

整个OpenStack是由控制节点，计算节点，网络节点，存储节点四大部分组成。其中：
控制节点负责对其余节点的控制，包含虚拟机建立，迁移，网络分配，存储分配等等
计算节点负责虚拟机运行
网络节点负责对外网络与内网络之间的通信
存储节点负责对虚拟机的额外存储管理等等

- 多节点部署
- 单节点部署
- 网络配置
- 节点角色

### 1.2 openstack部署

## 2. 本周主要工作内容

### 2.1 已经完成工作

**参考：**[技术博客](http://d-prototype.com/archives/8278)完成openstack部署

**部署环境：**windows 10 ubuntu子系统
```
cat /proc/version
Linux version 4.4.0-43-Microsoft (Microsoft@Microsoft.com) (gcc version 5.4.0 (GCC) ) #1-Microsoft Wed Dec 31 14:42:53 PST 2014
```

**网络：**
- IP静态分配
- 可以访问外网

1. 设置APT
修改 /etc/apt/sources.list 为以下内容
```
deb http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse
```

2. 安装git
```
StellaSong@DESKTOP-5E51N0B:~$ git --version
git version 2.7.4
```

3. 安装python-pip
```
StellaSong@DESKTOP-5E51N0B:~$ pip -V
pip 10.0.0b2 from /usr/local/lib/python2.7/dist-packages/pip-10.0.0b2-py2.7.egg/pip (python 2.7)
```

4. 使用豆瓣网的PIP源
```
StellaSong@DESKTOP-5E51N0B:~/.pip# cat pip.conf 
[global] 
timeout = 6000 
index-url = http://pypi.douban.com/simple/ 
[install] 
trusted-host = pypi.douban.com
root@adamhuan-devstack:~/.pip# 
```

5. 下载DEVSTACK
```
git clone https://github.com/openstack-dev/devstack.git
```

6. 创建UBUNTU用户stack
```
StellaSong@DESKTOP-5E51N0B:/$ id stack
uid=1001(stack) gid=1001(stack) groups=1001(stack)
```

7. 配置文件local.conf
```
[[local|localrc]]

DEST=/opt/stack
LOGDIR=$DEST/logs
LOGFILE=$LOGDIR/stack.sh.log
#OFFLINE=True

HOST_IP=172.19.55.254
SERVICE_HOST=172.19.55.254
MYSQL_HOST=172.19.55.254
RABBIT_HOST=172.19.55.254
GLANCE_HOSTPORT=172.19.55.254:9292

ADMIN_PASSWORD=abcd1234
DATABASE_PASSWORD=abcd1234
RABBIT_PASSWORD=abcd1234
SERVICE_PASSWORD=abcd1234

GIT_BASE=http://git.trystack.cn

disable_service n-net

NOVNC_REPO=http://git.trystack.cn/kanaka/noVNC.git
SPICE_REPO=http://git.trystack.cn/git/spice/spice-html5.git
enable_service s-proxy s-object s-container s-account h-eng h-api h-api-cfn h-api-cw q-svc q-dhcp q-meta q-agt q-l3 c-bak n-spice

Q_USE_SECGROUP=True
FLOATING_RANGE="172.19.55.0/24"
FIXED_RANGE="10.0.0.0/24"
Q_FLOATING_ALLOCATION_POOL=start=172.19.55.181,end=172.19.55.189
PUBLIC_NETWORK_GATEWAY="172.19.55.1"
Q_L3_ENABLED=True
PUBLIC_INTERFACE=eth0

Q_USE_PROVIDERNET_FOR_PUBLIC=True
OVS_PHYSICAL_BRIDGE=br-ex
PUBLIC_BRIDGE=br-ex
OVS_BRIDGE_MAPPINGS=public:br-ex
```

8. 安装DevStack
```
./stack.sh
（省略安装过程）
---报错---
WARNING: Using lib/neutron-legacy is deprecated, and it will be removed in the future
[Call Trace]
./stack.sh:607:source
/mnt/d/Study/stack/devstack/lib/neutron:121:source
/mnt/d/Study/stack/devstack/lib/neutron-legacy:226:die_if_not_set
/mnt/d/Study/stack/devstack/functions-common:212:die
[ERROR] /mnt/d/Study/stack/devstack/functions-common:226 Failure retrieving default route device
Error on exit
/bin/sh: 1: brctl: not found
```

### 2.2 未完成工作
安装DevStack之后的工作

### 2.3 问题与困难
无法解决安装DevStack时报错问题

## 3. 下周工作计划
试图解决安装DevStack时报错问题

## 4. 建议与意见（如有）

