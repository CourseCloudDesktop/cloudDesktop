# Neutron学习
## Neutron功能
- 二层交换：透过linux bridge或OVS虚拟出交换机，创建出局域网
- 三层路由：透过虚拟出路由器，实现网络间的互通
- 实现网络隔离：在同一网络下的虚拟机接受同一样的广播信息，不同网络之间不可见
- 提供三层服务：提供防火墙、dhcp、NAT等的三层服务

## Neutron架构
### Neutron server
- 向上提供API，接受来至Horizon(用户)、Nona的请求
- 向下透过Queue与Neutron plugin交互，提供实现网络的细节
![](images/neutron_server.png)
### Neutron plugin
- 透过监听Queue，接受Neutron server的信息，确认网络结构，并将信息存在Neutron DB里
- 透过Queue向Neutron agent发送命令，实现网络部件的虚拟化
### Neutron agent
- 透过监听Queue，接受Neutron plugin的信息，确认要创建虚拟化部件命令
- 透过向Neutron DB读取要创建部件的细节(接口名字，网段号等)
- 实现网络部件的虚拟化
### Network provider
- 虚拟网络下的结构及其结构下的元件
- 主要的network provider为：linux bridge及OVS

## linux-bridge
### linux-bridge下的local网络
- 处于该网络下的虚拟机能互相访问
- 网络对外及寄宿主机不可见
- 现实中的应用不多，多用于个人的测试机小数场景
![](images/linux_bridge_local_net.png)
### linux-bridge下的flat网络
- 每一个vlan网络必须要跟一张物理网卡绑定
- 现实中应用不多，因为当该网络数目很大时，现实中往往不能提供同能数量物理网卡
![](images/linux_bridge_flat_net.png)
### linux-bridge下的vlan网络
- 同一张的物理网卡可对应多个的vlan
- 透过为网络挂载vlan interface，实现多个网络的识别
- 挂载在同一张物理网卡下的不同vlan之间并不可互相访问
![](images/linux_bridge_vlan_net.png)
### linux-bridge下的lay3网络
- 
![](images/linux_bridge_router_net.png)
### linux-bridge下访问外网
![](images/linux_bridge_router_ext_net.png)

## OpenVSwitch(OVS)
### OVS下的local网络
![](images/ovs_local_net.png)
### OVS下的flat网络
![](images/ovs_flat_net.png)
### OVS下的vlan网络
![](images/ovs_vlan_net.png)
